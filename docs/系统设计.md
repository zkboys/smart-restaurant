# 系统设计

## 账号期限限制
每一个账号有有效期，到期之后不可用

## 营销推广
1. 前期自己推广，保证别饿死
1. 系统完善之后，找第三方销售公司合作，给他们提供一个平台，可以开账号，可以维护用户，我们每一个门店收取固定的费用，卖多少钱，销售公司决定。

## 收费
1. 较少门店，以门店为单位进行收费管理，不同的门店有自己的开通及到期时间，单独收费维护。
1. 较多门店，以后再说，可以提供统一设置功能，批量设计门店过期时间。可以适当的延长某几个门店过期时间

## 期限规则设定
1. 门店设置开通时间及到期时间，门店到期之后，品牌无法选择此门店（显示为已过期，不可用，提示续费）
1. 如果一个品牌的所有门店都过期，则此品牌过期（者显示为已经过期不可用，提示续费）
1. 如果一个账号有多个品牌或者一个品牌，中所有门店都过期，可以登录，进入选择品牌页面，此页面展示所有已过期门店

## 商户账号管理
1. 商户可以创建任意多个账号，任意多个角色权限
1. 门店可以创建本门店账号，指定本店可用角色
1. 商户不可以创建品牌，不可以创建门店，与平台沟通，提供资料之后，平台操作开通
1. 账号是否拥有品牌、门店，通过关联mchId storeId 进行限制
1. 账号权限通过品牌角色、门店角色进行限制
1. bops新开一个账号为管理员账号（mp系统的管理员），通过is_admin字段区分，拥有mp系统的所有权限

## 角色
角色分为两种，品牌角色、门店角色，可以用一个type字段区分

因为品牌、门店操作平台有两套不同的菜单、权限，所以需要两种角色

1. 品牌级别显示品牌角色和门店角色，创建时可以选择角色类型
1. 品牌角色，各门店平台不可见，只能在品牌操作页面可见
1. 品牌创建的门店角色，在所有门店都可见。各个门店可以选择是否使用
1. 默认几个品牌角色，由平台提供，mp端不可修改，只能使用
    1. 财务经理
    1. 市场经理
    1. 仓库管理员

1. 默认几个门店角色，由平台提供，mp端不可修改，只能使用
    1. 店长：拥有门店的所有权限。
    1. 服务员：点餐等操作
    1. 收银员：

1. 门店级别创建的角色都是门店角色，而且只在此门店下可见（门店自己玩），角色菜单+权限只能选择门店级别。

## 选择品牌、门店逻辑
登录之后。。。

1. 单个品牌
    1. 单个门店
        1. 拥有品牌角色，直接进入品牌操作页面
        1. 只拥有门店角色，直接进入门店操作界面
    1. 多个门店
        1. 拥有品牌角色，直接进入品牌操作界面
        1. 只拥有门店角色，进入选择门店页面，进入门店操作界面

1. 多个品牌
    1. 选择品牌
        1. 单个门店
            1. 拥有品牌角色，直接进入品牌操作页面
            1. 只拥有门店角色，直接进入门店操作界面
        1. 多个门店
            1. 拥有品牌角色，直接进入品牌操作界面
            1. 只拥有门店角色，进入选择门店页面，进入门店操作界面


## 品牌、门店菜单
不同品牌，不同门店的菜单要可配置，用于功能限制或则过滤掉不需要的功能

1. 品牌、门店，单独维护一套菜单（权限）
1. 菜单项分为通用、各类型菜单（正餐、快餐、西餐、外卖等等，这块设计注意扩展性）
1. 通用菜单各个品牌、门店默认就拥有
1. 类型菜单，根据门店的类型（新开门店必填类型），确认是否在此门店下显示
1. 品牌的菜单要根据各门店类型确认，要包含所有类型的菜单

## 菜品
一个库表存储所有菜品的基本信息，无论是门店、还是品牌创建的菜品

1. 品牌创建的菜品为贯标菜，各个门店都可以决定是否出售贯标菜。
1. 门店创建的菜品属于特殊菜，专属于此门店，其他门店看不到。

## 小票打印机
提供云小票打印机、本地小票打印机两种

1. 本地小票打印机
    1. android提供配置页面，输入局域网ip+端口即可
    1. 浏览器，提供一个java的服务包，本地安装之后与浏览器通信，实现本地小票打印机
1. 云打印机，各端（android mp）提供配置页面即可

## 支付
品台不提供支付接口，所有的钱都不经过平台，否则会设计财务对账方面的问题

线上支付其实只有两种方式：微信、支付宝（如果提供可key），其他（刷卡、现金等等）都属于线下支付

1. 商家自己提供二维码，收钱吧、个人微信、个人支付宝等，mp收款时，只提供一个输入框，一个支付方式，输入客户实际支付的金额，记录支付方式即可。
1. 商家提供自己的微信、支付宝相关的key，通过mp进行配置，系统可以生成支付相关的二维码。

## 注意的功能

1. 多个桌子合并桌台，一起结账
1. 关键性操作要记录操作人员，比如退菜等操作
1. 手机点餐，而不是pad点餐，pad比较笨重，手机成本更低，更灵活。

## 离线使用问题
暂时不要做，意义不大

1. 支持离线工程量比较大
1. 断网情况很少见


